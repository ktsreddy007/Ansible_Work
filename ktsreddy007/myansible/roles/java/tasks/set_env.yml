---
- name: "Find JAVA_HOME path"
  command: readlink -f $(which java)
  register: java_bin_path

- name: "Extract JAVA_HOME directory"
  set_fact:
    java_home: "{{ java_bin_path.stdout | regex_replace('/bin/java$', '') }}"

- name: "Set Java environment variables globally"
  template:
    src: java.sh.j2
    dest: /etc/profile.d/java.sh
    mode: '0755'
  become: yes
